# 主机发现

## ping扫描

### nmap

```bash
nmap -sn 192.168.88.0/24	#-sn和-sP差不多
nmap -sP 192.168.88.0/24
```

## tcp扫描

nmap工具有分很多参数进行tcp扫描

## arp扫描

### arp-scan

```bash
sudo arp-scan 192.168.88.0/24
```

### nmap

```bash
sudo nmap -PR 192.168.1.0/24
```

## snmp扫描

# 端口扫描

## TCP SYN扫描

**原理**：发送TCP SYN（同步）包以尝试建立连接。如果目标端口开放，目标主机会返回SYN/ACK（同步/确认）包。如果端口关闭，目标主机会返回RST（复位）包。扫描器不完成握手，以避免日志记录。

**优点**：快速且隐蔽，适用于大规模扫描。

**缺点**：可能被防火墙或入侵检测系统（IDS）检测到。

## TCP Connect扫描

**原理**：完成完整的三次握手（SYN, SYN/ACK, ACK），然后立即关闭连接。如果端口开放，则握手成功，否则返回RST包。

**优点**：无需特殊权限，结果可靠。

**缺点**：较慢且容易被检测和记录。

## TCP FIN扫描

**原理**：发送TCP FIN（终止）包。如果端口关闭，目标主机会返回RST包；如果端口开放，则不会有响应。

**优点**：可以绕过一些简单的防火墙和过滤规则。

**缺点**：不适用于所有系统（如Windows）。

## TCP Xmas扫描

**原理**：发送带有FIN、URG和PUSH标志的TCP包。如果端口关闭，目标主机会返回RST包；如果端口开放，则不会有响应。

**优点**：适用于绕过某些防火墙规则。

**缺点**：不适用于所有系统（如Windows）。

## TCP ACK扫描

**原理**：发送TCP ACK包，不试图建立连接。此方法用于探测防火墙规则和确定是否有状态检测。不能直接判断端口是否开放，但可以确定是否存在防火墙。

**优点**：识别防火墙规则。

**缺点**：不能直接判断端口状态。

## TCP Window 扫描

**原理**：基于TCP窗口大小的变化来判断端口状态。不同状态的端口可能会返回不同的窗口大小。

**优点**：可以绕过一些防火墙和IDS。

**缺点**：依赖于操作系统的特定实现。

## TCP Maimon 扫描

**原理**：发送包含FIN（终止）和ACK（确认）标志的TCP包。如果端口关闭，目标主机会返回RST包；如果端口开放，则返回一个TCP RST包

**优点**：可以绕过一些防火墙和IDS。

**缺点**：依赖于操作系统的特定实现。

## UDP 扫描

**原理**：发送UDP包到目标端口，如果端口关闭，目标主机会返回ICMP端口不可达消息。如果没有响应，则可能端口开放或被过滤。

**优点**：可以探测UDP服务。

**缺点**：由于UDP是无连接协议，扫描速度较慢且准确度不如TCP扫描。

## SCTP INIT 扫描

**原理**：发送SCTP INIT包来探测目标端口的状态。如果端口开放，会返回INIT-ACK；如果端口关闭，会返回ABORT。

**优点**：适用于SCTP协议的端口扫描。

**缺点**：较少使用，仅适用于特定协议。

## SCTP COOKIE-ECHO 扫描

**原理**：发送SCTP COOKIE-ECHO包来探测目标端口的状态。

**优点**：绕过简单的防火墙规则。

**缺点**：仅适用于SCTP协议。

## Idle 扫描

**原理**：利用第三方僵尸主机（Idle Host）进行扫描，通过发送伪造的IP包来隐匿真实扫描源。通过监测僵尸主机的IP标识符（IP ID）变化来判断目标端口状态。

**优点**：高度隐蔽，难以追踪扫描源。

**缺点**：设置复杂，依赖于找到合适的僵尸主机。

## 协议扫描

**原理**：探测目标主机开放的特定协议端口（如ICMP、GRE等）。

**优点**：发现非TCP/UDP协议的开放端口。

**缺点**：较少使用，特定于目标协议。